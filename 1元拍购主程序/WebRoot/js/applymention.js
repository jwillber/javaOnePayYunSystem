var CBLFun=null;$(document).ready(function(){var a=function(){var b=function(){var C=$("#txtAppMoney");var F=$("#txtUserName");var G=$("#txtBankName");var I=$("#txtSubBank");var z=$("#txtBankNo");var A=$("#txtPhone");var T=$("#txtCZMoney");var y=$("#userId").val();$("#linkApply").click(function(){$(this).removeClass("current2").addClass("current");$("#linkRecharge").removeClass("current");$("#divSQTX").show();$("#divTip").show();$("#divSQCZ").hide();C.focus()});$("#linkRecharge").click(function(){$("#linkApply").removeClass("current").addClass("current2");$(this).addClass("current");$("#divSQTX").hide();$("#divTip").hide();$("#divSQCZ").show();T.focus()});var S=d();if(S.t!=undefined){$("#linkRecharge").click()}var K=function(e,f){e.value=e.value.replace(f=="."?(/[^\d.]/g):(/[^\d-]/g),"");e.value=e.value.replace(f=="."?(/^\./g):(/^\-/g),"");e.value=e.value.replace(f=="."?(/\.{2,}/g):(/\-{2,}/g),f);e.value=e.value.replace(f,"$#$").replace(f=="."?(/\./g):(/\-/g),"").replace("$#$",f)};z.bind("keyup",function(e){z.val(z.val().replace(/\s/g,"").replace(/(\w{4})(?=\w)/g,"$1 "))});var R=function(f,e){f.siblings("span").attr("class","oran").html("<em></em>"+e)};var O=function(f,e){f.siblings("span").attr("class","").html(e)};$("input[type='text']").keyup(function(){var e=$(this);var f=e.val();if(f!=""){O(e,"");if(parseInt(f)==0){e.val(0)}}}).blur(function(){var e=parseInt($(this).attr("tip"));M=null;J=true;switch(e){case 1:B();break;case 2:E();break;case 3:N();break;case 4:P();break;case 5:L();break;case 6:D();break}});var H={money:"",userName:"",bankName:"",subBank:"",bankNo:"",phone:""};var M=null;var J=true;var Q=/^[\u4e00-\u9fa5]{2,30}$/;var B=function(){if(C.val()==""){R(C,"\u8bf7\u8f93\u5165\u63d0\u73b0\u91d1\u989d");J=false}else{var g=parseFloat($("#spanBrokerage").html());var e=parseFloat(C.val());var f=/^\d{1,9}(\.\d{1,2})?$/;if(!f.exec(e)){R(C,"\u63d0\u73b0\u91d1\u989d\u4e3a\u6b63\u6574\u6570\u6216\u5e26\u4e24\u4f4d\u5c0f\u6570");J=false}else{if(e>g){R(C,"\u8f93\u5165\u989d\u8d85\u51fa\u53ef\u63d0\u73b0\u91d1\u989d");J=false}else{if(e<100){R(C,"\u63d0\u73b0\u91d1\u989d\u987b\u81f3\u5c11100\u5143");J=false}}}}if(!J&&M==null){M=C}};var E=function(){var e=F.val();if(e==""){R(F,"\u8bf7\u8f93\u5165\u5f00\u6237\u4eba");J=false;if(M==null){M=F}}else{if(!Q.test(e)){R(F,"\u5f00\u6237\u4eba\u8f93\u5165\u6709\u8bef");J=false}}};var N=function(){var e=G.val();if(e==""){R(G,"\u8bf7\u8f93\u5165\u94f6\u884c\u540d\u79f0");J=false;if(M==null){M=G}}else{if(!Q.test(e)){R(G,"\u94f6\u884c\u540d\u79f0\u8f93\u5165\u6709\u8bef");J=false}}};var P=function(){var e=I.val();if(e==""){R(I,"\u8bf7\u8f93\u5165\u5f00\u6237\u652f\u884c");J=false;if(M==null){M=I}}else{if(!Q.test(e)){R(I,"\u5f00\u6237\u652f\u884c\u8f93\u5165\u6709\u8bef");J=false}}};var L=function(){if(z.val()==""){R(z,"\u8bf7\u8f93\u5165\u94f6\u884c\u5e10\u53f7");J=false}else{var e=/^\d{16,19}$/;if(!e.test(z.val().replace(/[ ]/g,""))){R(z,"\u94f6\u884c\u8d26\u53f7\u4e3a16-19\u4f4d\u6570\u5b57");J=false}}if(!J&&M==null){M=z}};var D=function(){var e=/(^1+[0-9]{10}$)|(^(0[0-9]{2,3}\-)+([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$)/;if(A.val()==""){R(A,"\u8bf7\u8f93\u5165\u8054\u7cfb\u7535\u8bdd");J=false}else{if(!e.test(A.val())){R(A,"\u8054\u7cfb\u7535\u8bdd\u683c\u5f0f\u6709\u8bef\uff0c\u56fa\u8bdd\u683c\u5f0f\u5982\uff1a0755-22228888");J=false}}if(!J&&M==null){M=A}};$("#btnSQTX").click(function(){M=null;J=true;B();E();N();P();L();D();if(!J){M.focus();return false}H.money=C.val();H.userName=F.val();H.bankName=G.val();H.subBank=I.val();H.bankNo=z.val().replace(/[ ]/g,"");H.phone=A.val();var e='{"userId":"'+y+'","money":"'+H.money+'","bankUser":"'+H.userName+'","bankName":"'+H.bankName+'","bankSubbranch":"'+H.subBank+'","bankNo":"'+H.bankNo+'","phone":"'+H.phone+'"}';$.ajax({url:"/user/ApplyMentionAdd.html",data:"userJSON="+encodeURIComponent(e),type:"post",success:function(f){if(f=="success"){C.val("");F.val("");G.val("");I.val("");z.val("");A.val("");var g=parseFloat($("#spanBrokerage").html());var h=c(g-parseFloat(H.money));$("#spanBrokerage2").html(h);$("#spanBrokerage").html(h);$.PageDialog('<dl class="sAltOK"><dd>\u7533\u8bf7\u6210\u529f\uff0c\u8bf7\u7b49\u5f85\u5ba1\u6838!</dd></dl>',{W:218,H:50,autoClose:true})}else{if(f=="moneyError"){$.PageDialog('<dl class="sAltFail"><dd>\u60a8\u8f93\u5165\u7684\u91d1\u989d\u6709\u8bef\uff01</dd></dl>',{W:218,H:50,autoClose:true})}else{alert("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb\uff01")}}},error:function(){alert("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb\uff01")}})});T.keyup(function(){this.value=this.value.replace(/[^\d]/g,"")});$("#btnSQCZ").click(function(){var i=true;var g=parseFloat($("#spanBrokerage2").html());if(g<1){R(T,"\u60a8\u73b0\u6709\u4f63\u91d1\u4e0d\u6ee11\u5143");i=false}else{if(T.val()==""){R(T,"\u8bf7\u8f93\u5165\u5145\u503c\u91d1\u989d");i=false}else{var h=/^[1-9]+[0-9]*]*$/;if(!h.test(T.val())){R(T,"\u8bf7\u8f93\u5165\u6b63\u6574\u6570");i=false}else{if(parseFloat(T.val())>g){R(T,"\u8f93\u5165\u7684\u91d1\u989d\u5927\u4e8e\u53ef\u7528\u4f63\u91d1");i=false}}}}if(!i){T.focus();return}var e='{"userId":"'+y+'","recharge":"'+T.val()+'"}';$.ajax({url:"/user/ApplyMentionAddToUser.html",data:"userJSON="+encodeURIComponent(e),type:"post",success:function(j){if(j=="success"){$.PageDialog('<dl class="sAltOK"><dd>\u64cd\u4f5c\u6210\u529f!</dd></dl>',{W:160,H:50,autoClose:true});f()}else{if(j=="moneyError"){$.PageDialog('<dl class="sAltFail"><dd>\u60a8\u8f93\u5165\u7684\u91d1\u989d\u6709\u8bef\uff01</dd></dl>',{W:218,H:50,autoClose:true})}else{alert("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb\uff01")}}},error:function(){alert("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb\uff01")}});var f=function(){var j=c(g-parseFloat(T.val()));$("#spanBrokerage2").html(j);$("#spanBrokerage").html(j);T.val("")}});C.focus()};CBLFun=new b()};function d(){var e=location.search;var b=new Object();if(e.indexOf("?")!=-1){var g=e.substr(1);strs=g.split("&");for(var f=0;f<strs.length;f++){b[strs[f].split("=")[0]]=unescape(strs[f].split("=")[1])}}return b}function c(b){return Math.round(b*Math.pow(10,2))/Math.pow(10,2)}a()});
