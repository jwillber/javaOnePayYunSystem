$(function(){var d=$skin;var c=function(){var O=["\u539f\u59cb\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a","\u5bc6\u7801\u4e0d\u8db36\u4f4d","\u539f\u59cb\u5bc6\u7801\u9519\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165"];var K=["\u65b0\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a","\u5bc6\u7801\u4e0d\u8db36\u4f4d","\u65b0\u5bc6\u7801\u9519\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165"];var P=["\u786e\u8ba4\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a","\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4,\u8bf7\u91cd\u65b0\u8f93\u5165"];var D="";var Q="";var H="";var E="";var x=0;var z=0;var b=0;var J=false;var I=true;var A=false;var a=$("#userId").val();var F=function(f,g){if(!A){f.focus()}f.parent().next().addClass("wrong").html("<s></s>"+g)};var y=function(f){if(!f){return}A=true;D=f};var C=function(g){var f=/^[^ \f\n\r\t\v]{6,20}$/;if(!f.exec(g)){return false}return true};var M=function(g){if(!g){return}var h=e(g);var j=$("#l"+g);var f="";var i="";A=false;switch(g){case"OldPass":x=2;if(h==""){Q="";f="wrong";i=O[0];x=0;J=false}else{if(!C(h)){f="wrong";i=O[1];Q=h;x=1;_IsNameInit=0;J=false}else{f="ok";i="&nbsp;";Q=h;x=2;_IsNameInit=0;J=true}}break;case"NewPass":z=2;if(h==""&&E!=""){f="wrong";i=K[0];H=h;z=0;_IsNameInit=0;J=false}else{if(h==""){f="wrong";i=K[0];H=h;z=0;_IsNameInit=0;J=false}else{if(!C(h)){f="wrong";i=K[1];H=h;z=1;_IsNameInit=0;J=false}else{if(E!=""&&h!=E){f="wrong";i=P[1];H=h;b=1;_IsNameInit=0;D="NewPassAgain";J=false;j.attr("class","ok").html("<s></s>");j=$("#lNewPassAgain")}else{if(E!=""&&h==E){f="ok";i="&nbsp;";H=h;b=2;_IsNameInit=0;J=true;j.attr("class","ok").html("<s></s>");j=$("#lNewPassAgain")}else{f="ok";i="&nbsp;";H=h;z=2;_IsNameInit=0;J=true}}}}}break;case"NewPassAgain":b=2;if(h==""){f="wrong";i=P[0];b=0;E="";_IsNameInit=0;J=false}else{if(H==""){f="wrong";i=K[0];E=h;b=0;_IsNameInit=0;D="NewPass";J=false;j=$("#lNewPass")}else{if(h!=H){f="wrong";i=P[1];b=1;E=h;_IsNameInit=0;J=false}else{f="ok";i="&nbsp;";E=h;b=2;_IsNameInit=0;J=true}}}break;default:break}if(i!=""){if(f=="ok"){j.attr("class","ok").html("<s></s>")}else{j.attr("class",f).html("<s></s>"+i)}}_IsNameInit=1};var N=function(){$.PageDialog('<dl class="sAltOK"><dd>\u4fee\u6539\u6210\u529f!</dd></dl>',{W:160,H:50,autoClose:true});location.replace("/user/UpdatePassWord.html")};var B=function(){if(!isLoaded){return}$.ajax({url:"/user/updatePwd.html",data:"userId="+a+"&id="+Q+"&userJSON="+H,success:function(f){if(f=="success"){N()}else{$("#btnSubmitSave").show();$("#SaveSubmitStatus").hide();$("#OldPass").focus();$("#lOldPass").attr("class","wrong").html("<s></s>"+O[2])}},error:function(){alert("\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u4e0e\u7ba1\u7406\u5458\u8054\u7cfb\uff01")}})};var G=function(){if(!isLoaded){return}I=true;var f=$("#OldPass");if(x==0){F(f,O[0]);I=false}if(x==1){F(f,O[1]);I=false}var g=$("#NewPass");if(z==0){F(g,K[0]);I=false}if(z==1){F(g,K[1]);I=false}var h=$("#NewPassAgain");if(b==0){F(h,P[0]);I=false}if(b==1||h.val()!=g.val()){F(h,P[1]);I=false}if(I==true){B()}};$("input[type='password']").bind("focus",function(){y(this.id)}).bind("blur",function(){M(this.id)}).removeAttr("disabled");var L=$("#NewPass");L.bind("keyup",function(g){var m=$("#pwdStrength");var k=$("#tdStrength");var h=["gray45","red","yellow","green"];var i=["","\u5f31","\u4e2d","\u5f3a"];var f=function(o){var n="";for(var p=1;p<=3;p++){if(p==o){n+='<li class="'+h[o]+'"></li>'}else{n+='<li class="'+h[0]+'"></li>'}}m.html(n);k.html("<span>"+i[o]+"</span>")};var l=$("#lNewPass");var j=function(n){if(n.length>=6){l.attr("class","ok").html("<s></s>");if(/[a-zA-Z]+/.test(n)&&/[0-9]+/.test(n)&&/\W+\D+/.test(n)){f(3)}else{if(/[a-zA-Z]+/.test(n)&&/[0-9]+/.test(n)){f(2)}else{if(/\[a-zA-Z]+/.test(n)&&/\W+\D+/.test(n)){f(2)}else{if(/[0-9]+/.test(n)&&/\W+\D+/.test(n)){f(2)}else{f(1)}}}}}else{var o=n.length==0?K[0]:K[1];l.attr("class","wrong").html("<s></s>"+o);f(0)}};j(L.val())});$("#btnSubmitSave").bind("click",function(){G()});$("input[type='password']").bind("keydown",function(g){var f=(window.event)?event.keyCode:g.keyCode;if(f==32){return false}else{if(f==13){M(D);if(J){if(D=="NewPassAgain"){$("#btnSubmitSave").click()}else{$(D).parent().parent().next().next().find("input[type='password']").focus()}}else{$(D).focus()}return false}}return true});isLoaded=true};function e(b){return $("#"+b).val()}c()});
