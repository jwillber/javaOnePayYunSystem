$(document).ready(function(){var c=$www;var a=$www;var id=$("#topid").val();var typeId=$("#typeId").val();var typeName=$("#typeName").val();if(id=="hot20"){$("#hot20").attr("class","SortCur")}else{if(id=="date20"){$("#date20").attr("class","SortCur")}else{if(id=="price20"){$("#price20").attr("class","Price_Sort SortCur").html("\u4ef7\u683c <s></s>");if(typeId!=null&&typeId!=""){$("#price20").attr("href",$www+"/list/priceAsc20/"+typeId+".html")}else{$("#price20").attr("href",$www+"/list/priceAsc20.html")}}else{if(id=="priceAsc20"){$("#price20").attr("class","Price_Sort SortCur").html("\u4ef7\u683c <b></b>");if(typeId!=null&&typeId!=""){$("#price20").attr("href",$www+"/list/price20/"+typeId+".html")}else{$("#price20").attr("href",$www+"/list/price20.html")}}else{if(id=="about20"){$("#about20").attr("class","SortCur")}else{if(id=="surplus20"){$("#surplus20").attr("class","SortCur")}}}}}}var I=$("#ulBrandList");var A=I.height();var H=I.children("li").length;var Z=26;var B=false;var y=function(){var F=Z;var E=8;if(H%E==0){F=(H/E)*Z}else{F=parseInt(H/E+1)*Z}return F};if(y()<=26){$("#btnExpend").hide()}I.height(y()+"px");$("#btnExpend").click(function(E){E.preventDefault();if(!B){I.height(A+"px");$(this).addClass("MoreClick").html("\u6536\u8d77<i></i>")}else{I.height(y()+"px");$(this).removeClass("MoreClick").html("\u5c55\u5f00<i></i>")}B=!B});var p=0;var f=12;var h=60;var i=h/f;var k=1;var m=0;var v=$("#ulGoodsList");var t=$("#divPageNav");var o=$("#divLoadingLine");var r=false;var s=false;var n=false;var _Ptn=/^\d+$/;var _CartObj=$("#btnMyCart");var GoodsItemFun=function(){$(".goods-iten").each(function(){var d=$(this);var a=d.attr("codeid");var s=d.attr("sPrice");d.hover(function(){$(this).addClass("goods_Cur")},function(){$(this).removeClass("goods_Cur")});var e=d.find("div.gl_number");var b=e.find("input.num_dig");e.GoodsCountFun(b);var c=d.find("div.pic").find("img");d.find("div.go_buy").GoodsBuyFun(b,c,a,s)})};$.fn.GoodsCountFun=function(a){var f=parseInt(a.attr("surplus"));var sp=parseInt(a.attr("singlePrice"));var d=a.prev();var c=a.next();var e=a.parent().prev();var b=function(i,h){e.show().html(i).fadeOut(3000,function(){e.hide();a.val(h)})};var g=sp;a.keyup(function(i){var h=a.val();if(!_Ptn.test(h)){a.val(g)}else{if(h==0){b("\u6700\u5c11\u9700"+$shortName+sp+"\u4eba\u6b21",sp)}else{if(h<=f){g=h}else{b("\u6700\u591a\u80fd"+$shortName+""+f+"\u4eba\u6b21",f);a.val(f)}}}if(g==sp){d.addClass("num_ban");c.removeClass("num_ban")}else{if(g==f){d.removeClass("num_ban");c.addClass("num_ban")}}}).mouseover(function(){$(this).focus().select()});d.click(function(){var h=a.val();if(_Ptn.test(h)){var i=parseInt(h);if(i>sp){i-=sp;a.val(i);if(i==sp){d.addClass("num_ban")}c.removeClass("num_ban")}else{}}return false});c.click(function(){var h=a.val();if(_Ptn.test(h)){var i=parseInt(h);if(i<f){i+=sp;a.val(i);d.removeClass("num_ban");if(i==f){c.addClass("num_ban")}}else{}}return false})};$.fn.GoodsBuyFun=function(b,c,a,s){$(this).find("a").eq(0).click(function(){var d=b.val();var er=$(this).parent().parent().find(".error");if(_Ptn.test(d)){if(parseInt(d)>0&&parseInt(d)%s==0){$.ajax({url:"/list/isStatus.action?id="+a,type:"GET",success:function(data){if(data=="false"){b.parent().parent().parent().find("p[name='buyCount']").html("\u8be5\u5546\u54c1\u5df2\u6ee1\u5458\u8bf7\u9009\u62e9\u5176\u5b83\u5546\u54c1!").show()}else{var count=parseInt(data);var codeid=a;var json=getCookie("products");if(json==null||json==""){var val="[{'pId':"+codeid+",'num':"+d+"}]";SetCookieByExpires("products",val,1)}else{var flag=false;json=eval("("+json+")");$.each(json,function(n,value){if(codeid==value.pId){value.num=(parseInt(value.num)+parseInt(d));if((parseInt(value.num)+parseInt(d))>count){value.num=count}flag=true}});if(!flag){json.push({pId:+codeid,num:d})}json=JSON.stringify(json);SetCookieByExpires("products",json,1)}location.href=$www+"/mycart/index.html"}}})}else{b.focus().select();er.show().html("\u5fc5\u987b\u662f"+s+"\u7684\u500d\u6570").fadeOut(3000,function(){er.hide()})}}return true});$(this).find("a").eq(1).click(function(){var d=b.val();var er=$(this).parent().parent().find(".error");if(_Ptn.test(d)){if(parseInt(d)>0&&parseInt(d)%s==0){$.ajax({url:"/list/isStatus.action?id="+a,type:"GET",success:function(data){if(data=="false"){b.parent().parent().parent().find("p[name='buyCount']").html("\u8be5\u5546\u54c1\u5df2\u6ee1\u5458\u8bf7\u9009\u62e9\u5176\u5b83\u5546\u54c1!").show()}else{var count=parseInt(data);var codeid=a;var json=getCookie("products");if(json==null||json==""){var val="[{'pId':"+codeid+",'num':"+d+"}]";SetCookieByExpires("products",val,1)}else{var flag=false;json=eval("("+json+")");$.each(json,function(n,value){if(codeid==value.pId){value.num=(parseInt(value.num)+parseInt(d));if((parseInt(value.num)+parseInt(d))>count){value.num=count}flag=true}});if(!flag){json.push({pId:+codeid,num:d})}json=JSON.stringify(json);SetCookieByExpires("products",json,1)}$.ajax({url:"/mycart/getProductCartCount.html",type:"GET",success:function(data){var D=data;if(D>0){var h=$('<div id="cart_shadow" style="display: none;border:1px solid #aaa;z-index: 9999;"><img src="'+c.attr("src")+'" width="100%" /></div>').prependTo("body");h.css({width:c.css("width"),height:c.css("height"),position:"absolute",top:c.offset().top,left:c.offset().left}).show();h.animate({width:_CartObj.width(),height:_CartObj.height(),top:_CartObj.offset().top,left:_CartObj.offset().left,opacity:0.5},{queue:false,duration:600,complete:function(){h.remove();var ap=$("#divRigCart");var ah=ap.children("a").find("em");var N=$("#liTopCart");var at=N.find("strong");at.html(D>99?"N+":D);ah.html((D>99?"N+":D)).show()}})}}})}}})}else{b.focus().select();er.show().html("\u5fc5\u987b\u662f"+s+"\u7684\u500d\u6570").fadeOut(3000,function(){er.hide()})}}return false})};GoodsItemFun();var loaded=false;function show(){var top=$(".Roll_Con").offset().top;if(!loaded&&$(window).scrollTop()+$(window).height()>top){$.ajax({url:"/lottery/upcomingAnnouncedByTop.action?pageNo="+1+"&pageSize="+10,type:"get",data:"json",success:function(data){for(var i=0;i<data.length;i++){$('<li id="'+i+'"><div class="pic"><a title="'+data[i].productTitle+'" target="_blank" href="'+$www+"/products/"+data[i].productId+'.html" rel="nofollow"><img alt="'+data[i].productName+'" src="'+$img+data[i].headImage+'"></a></div><p class="name"><a title="'+data[i].productTitle+'" target="_blank" href="'+$www+"/products/"+data[i].productId+'.html">'+data[i].productName+'</a></p><p class="money">\u4ef7\u503c\uff1a<span class="rmbgray">'+data[i].productPrice+'.00</span></p><div class="go_buy"><a rel="nofollow" class="go_Shopping12" title="\u7acb\u5373'+$saitName+'" target="_blank" href="'+$www+"/products/"+data[i].productId+'.html">\u7acb\u5373'+$saitName+"</a></div></li>").appendTo("#ulRecommend")}$.getScript(a+"/js/recommendpicfun.js")}});loaded=true}}$(window).scroll(show);$(".scrollLoading").scrollLoading();function SetCookie(name,value){document.cookie=name+"="+escape(value)+";id=1ypg;path=/;domain="+$domain}function SetCookieByExpires(name,value,date){var Days=date;var exp=new Date();exp.setTime(exp.getTime()+Days*24*60*60*1000);document.cookie=name+"="+escape(value)+";id=1ypg;path=/;expires="+exp.toGMTString()+";domain="+$domain}function getCookie(name){var arr=document.cookie.match(new RegExp("(^| )"+name+"=([^;]*)(;|$)"));if(arr!=null){return unescape(arr[2])}return null}function delCookie(name){var exp=new Date();exp.setTime(exp.getTime()-1);var cval=getCookie(name);if(cval!=null){document.cookie=name+"="+cval+";id=1ypg;path=/;expires="+exp.toGMTString()+";domain="+$domain}}$.getScript(a+"/js/json2.js")});
