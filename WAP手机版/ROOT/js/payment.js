$(function(){var d=false;var c=function(){var b=parseInt($("#hidShopMoney").val());var S=$("#hidBalance").val();var B=parseInt($("#hidPoints").val());var T=$("#spPoints");var F=$("#spBalance");var O=null;var I=$("#bankList");var D="\u7f51\u94f6+";var P=parseInt(B/100)>b?b:parseInt(B/100);var y=0;var R=0;var L=function(e,f,g,h){$.PageDialog.fail(e,f,g,h)};var a=function(e,f,g){$.PageDialog.confirm(e,f,g)};if(P<b){var M=parseInt(S);if(M>0){var N=b-P;if(M>=N){y=N}else{y=M;R=N-M}}else{R=b-P}}var E=function(e){P=e;if(e>0){T.parent().removeClass("z-pay-grayC");T.attr("sel","1").attr("class","z-pay-mentsel").next("span").html('\u798f\u5206\u652f\u4ed8<em class="orange">'+e+".00</em>\u5143\uff08\u60a8\u7684\u798f\u5206\uff1a"+B+"\uff09")}else{T.attr("sel","0").attr("class","z-pay-ment").next("span").html('\u798f\u5206\u652f\u4ed8<em class="orange">0.00</em>\u5143\uff08\u60a8\u7684\u798f\u5206\uff1a'+B+"\uff09")}};var Q=function(e){y=e;if(e>0){F.parent().removeClass("z-pay-grayC");F.attr("sel","1").attr("class","z-pay-mentsel").next("span").html('\u4f59\u989d\u652f\u4ed8<em class="orange">'+e+".00</em>\u5143\uff08\u8d26\u6237\u4f59\u989d\uff1a"+S+" \u5143\uff09")}else{F.attr("sel","0").attr("class","z-pay-ment").next("span").html('\u4f59\u989d\u652f\u4ed8<em class="orange">0.00</em>\u5143\uff08\u8d26\u6237\u4f59\u989d\uff1a'+S+" \u5143\uff09")}};var K=function(e){R=e;if(e>0){O.html('<s class="z-arrow"></s>\u9009\u62e9'+(D=="\u7f51\u94f6"?"\u7f51\u94f6":'<b class="z-mlr">'+D+"</b>")+"\u652f\u4ed8"+((P>0||y>0)?"\u5269\u4f59":"")+'<em class="orange">'+R+".00</em>\u5143");O.removeClass("z-pay-grayC").nextAll().show();G=true}else{O.addClass("z-pay-grayC").html('<s class="z-arrow"></s>\u9009\u62e9\u7f51\u94f6\u652f\u4ed8').nextAll().hide();G=false}};if(parseInt(B/100)>0){T.parent().click(function(){K(0);if(T.attr("sel")==1){E(0);H(b)}else{var e=parseInt(B/100);if(e>0){E(e>=b?b:e);H(e>=b?0:b-e)}else{H(b)}}});var H=function(e){if(F.attr("sel")==1){var f=parseInt(S)-e;if(f>0){Q(e)}else{Q(parseInt(S));K(-f)}}else{K(e)}}}if(parseInt(S)>0){F.parent().click(function(){K(0);if(F.attr("sel")==1){Q(0);J(b)}else{var e=parseInt(S);if(e>0){Q(e>=b?b:e);J(e>=b?0:b-e)}else{J(b)}}});var J=function(e){if(T.attr("sel")==1){var f=parseInt(B/100)-e;if(f>0){E(e)}else{E(parseInt(B/100));K(-f)}}else{K(e)}}}var G=false;var z=1;$("li",I).each(function(f){var e=$(this);if(f==0){O=e;O.click(function(){if(!O.hasClass("z-pay-grayC")){if(!G){O.nextAll().show();G=true}else{O.nextAll().hide();G=false}}})}else{e.click(function(){z=f;D=e.text();e.children("i").attr("class","z-bank-Roundsel");e.siblings().each(function(){$(this).children("i").attr("class","z-bank-Round")});O.html('<s class="z-arrow"></s>\u9009\u62e9<b class="z-mlr">'+D+"</b>\u652f\u4ed8"+((P>0||y>0)?"\u5269\u4f59":"")+'<em class="orange">'+R+".00</em>\u5143")})}});if(R>0){O.removeClass("z-pay-grayC").html('<s class="z-arrow"></s>\u9009\u62e9<b class="z-mlr">'+D+"</b>\u652f\u4ed8"+((P>0||y>0)?"\u5269\u4f59":"")+'<em class="orange">'+R+".00</em>\u5143").nextAll().show();G=true}else{O.addClass("z-pay-grayC").nextAll().hide();G=false}var C=$("#btnPay");var A=function(){if(!d){return}var e=function(){location.replace("/mycart/goPay.html?moneyCount="+b+"&integral="+P+"&userPayType=2");return false};var g=function(){location.replace("/mycart/goPay.html?moneyCount="+b+"&integral="+P+"&hidUseBalance="+y+"&userPayType=1");return false};var f=function(){location.replace("/mycart/goPay.html?moneyCount="+b+"&integral="+P+"&hidUseBalance="+y+"&userPayType=3");return false};if(P>=b){a("\u60a8\u786e\u5b9a\u4f7f\u7528\u798f\u5206\u62b5\u6263\u5417?",e)}else{if(y>=b){a("\u60a8\u786e\u5b9a\u4f7f\u7528\u8d26\u6237\u4f59\u989d\u652f\u4ed8\u5417?",g)}else{if(y+P>=b){a("\u60a8\u786e\u5b9a\u4f7f\u7528\u798f\u5206\u548c\u4f59\u989d\u652f\u4ed8\u5417?",f)}else{}}}};C.bind("click",A);d=true};$.getScript("/js/pagedialog.js",c)});
